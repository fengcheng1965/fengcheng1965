# 产品展示与业务沟通系统技术方案

## 一、系统架构设计

### 1.1 整体架构

```
┌─────────────────────────────────────────────────────┐
│                   前端展示层                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────┐  │
│  │ 产品展示模块 │  │ 搜索筛选模块 │  │ 沟通模块 │  │
│  └──────────────┘  └──────────────┘  └──────────┘  │
└─────────────────────────────────────────────────────┘
                        ↓
┌─────────────────────────────────────────────────────┐
│                  API接口层                           │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────┐  │
│  │ 产品数据API │  │ 搜索筛选API │  │ 沟通API │  │
│  └──────────────┘  └──────────────┘  └──────────┘  │
└─────────────────────────────────────────────────────┘
                        ↓
┌─────────────────────────────────────────────────────┐
│                  数据存储层                           │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────┐  │
│  │ 产品数据库   │  │ 用户数据库   │  │ 咨询数据库│  │
│  └──────────────┘  └──────────────┘  └──────────┘  │
└─────────────────────────────────────────────────────┘
```

### 1.2 技术栈选择

**前端技术**：
- HTML5 + CSS3 + JavaScript (ES6+)
- 框架：Vue.js 3 或 React 18
- UI组件库：Element Plus 或 Ant Design
- 图标库：Font Awesome 6
- HTTP客户端：Axios

**后端技术**：
- Node.js + Express 或 Python + Flask
- 数据库：MySQL 8.0 或 PostgreSQL
- ORM：Sequelize 或 Prisma
- 缓存：Redis
- 消息队列：RabbitMQ（可选）

**通讯技术**：
- WebSocket：Socket.io（即时聊天）
- RESTful API：数据交互
- 邮件服务：Nodemailer 或 SendGrid
- 短信服务：阿里云短信或腾讯云短信

---

## 二、数据库设计

### 2.1 产品表 (products)

```sql
CREATE TABLE products (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(200) NOT NULL COMMENT '产品名称',
    category_id INT COMMENT '分类ID',
    brand VARCHAR(100) COMMENT '品牌',
    price DECIMAL(10, 2) NOT NULL COMMENT '价格',
    original_price DECIMAL(10, 2) COMMENT '原价',
    specification TEXT COMMENT '规格参数（JSON格式）',
    description TEXT COMMENT '详细描述',
    features TEXT COMMENT '产品特点（JSON数组）',
    usage_method TEXT COMMENT '使用方法',
    precautions TEXT COMMENT '注意事项',
    image_urls TEXT COMMENT '图片URL（JSON数组）',
    thumbnail_url VARCHAR(500) COMMENT '缩略图',
    stock INT DEFAULT 0 COMMENT '库存',
    sales_count INT DEFAULT 0 COMMENT '销量',
    status TINYINT DEFAULT 1 COMMENT '状态：1-上架 0-下架',
    sort_order INT DEFAULT 0 COMMENT '排序',
    is_hot TINYINT DEFAULT 0 COMMENT '是否热销',
    is_new TINYINT DEFAULT 0 COMMENT '是否新品',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_category (category_id),
    INDEX idx_price (price),
    INDEX idx_status (status),
    FULLTEXT idx_search (name, description, brand)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='产品表';
```

### 2.2 产品分类表 (categories)

```sql
CREATE TABLE categories (
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(100) NOT NULL COMMENT '分类名称',
    parent_id INT DEFAULT 0 COMMENT '父分类ID',
    level TINYINT DEFAULT 1 COMMENT '层级',
    icon VARCHAR(200) COMMENT '图标',
    description TEXT COMMENT '描述',
    sort_order INT DEFAULT 0 COMMENT '排序',
    status TINYINT DEFAULT 1 COMMENT '状态',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_parent (parent_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='产品分类表';
```

### 2.3 产品规格表 (product_specs)

```sql
CREATE TABLE product_specs (
    id INT PRIMARY KEY AUTO_INCREMENT,
    product_id INT NOT NULL COMMENT '产品ID',
    spec_name VARCHAR(100) NOT NULL COMMENT '规格名称',
    spec_value VARCHAR(200) NOT NULL COMMENT '规格值',
    price DECIMAL(10, 2) COMMENT '规格价格',
    stock INT DEFAULT 0 COMMENT '规格库存',
    image_url VARCHAR(500) COMMENT '规格图片',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_product (product_id),
    FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='产品规格表';
```

### 2.4 用户表 (users)

```sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(100) COMMENT '用户名',
    phone VARCHAR(20) COMMENT '手机号',
    email VARCHAR(100) COMMENT '邮箱',
    password VARCHAR(255) COMMENT '密码（加密）',
    avatar VARCHAR(500) COMMENT '头像',
    real_name VARCHAR(100) COMMENT '真实姓名',
    company VARCHAR(200) COMMENT '公司名称',
    role TINYINT DEFAULT 0 COMMENT '角色：0-普通用户 1-管理员 2-客服',
    status TINYINT DEFAULT 1 COMMENT '状态',
    last_login_at TIMESTAMP NULL COMMENT '最后登录时间',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    UNIQUE INDEX idx_phone (phone),
    UNIQUE INDEX idx_email (email)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户表';
```

### 2.5 咨询表 (consultations)

```sql
CREATE TABLE consultations (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT COMMENT '用户ID',
    product_id INT COMMENT '产品ID',
    type TINYINT DEFAULT 1 COMMENT '类型：1-产品咨询 2-价格咨询 3-技术咨询 4-其他',
    subject VARCHAR(200) NOT NULL COMMENT '咨询主题',
    content TEXT NOT NULL COMMENT '咨询内容',
    contact_info TEXT COMMENT '联系方式（JSON）',
    status TINYINT DEFAULT 0 COMMENT '状态：0-待处理 1-处理中 2-已回复 3-已关闭',
    priority TINYINT DEFAULT 2 COMMENT '优先级：1-高 2-中 3-低',
    assigned_to INT COMMENT '分配给（客服ID）',
    reply_count INT DEFAULT 0 COMMENT '回复次数',
    last_reply_at TIMESTAMP NULL COMMENT '最后回复时间',
    is_read TINYINT DEFAULT 0 COMMENT '是否已读',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_user (user_id),
    INDEX idx_product (product_id),
    INDEX idx_status (status),
    INDEX idx_priority (priority),
    INDEX idx_created (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='咨询表';
```

### 2.6 咨询回复表 (consultation_replies)

```sql
CREATE TABLE consultation_replies (
    id INT PRIMARY KEY AUTO_INCREMENT,
    consultation_id INT NOT NULL COMMENT '咨询ID',
    user_id INT NOT NULL COMMENT '回复者ID',
    content TEXT NOT NULL COMMENT '回复内容',
    is_admin TINYINT DEFAULT 0 COMMENT '是否管理员回复',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_consultation (consultation_id),
    INDEX idx_user (user_id),
    FOREIGN KEY (consultation_id) REFERENCES consultations(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='咨询回复表';
```

### 2.7 聊天记录表 (chat_messages)

```sql
CREATE TABLE chat_messages (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    session_id VARCHAR(100) NOT NULL COMMENT '会话ID',
    from_user_id INT NOT NULL COMMENT '发送者ID',
    to_user_id INT NOT NULL COMMENT '接收者ID',
    content TEXT NOT NULL COMMENT '消息内容',
    type TINYINT DEFAULT 1 COMMENT '类型：1-文本 2-图片 3-文件',
    file_url VARCHAR(500) COMMENT '文件URL',
    is_read TINYINT DEFAULT 0 COMMENT '是否已读',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_session (session_id),
    INDEX idx_from (from_user_id),
    INDEX idx_to (to_user_id),
    INDEX idx_created (created_at)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='聊天记录表';
```

### 2.8 搜索关键词表 (search_keywords)

```sql
CREATE TABLE search_keywords (
    id INT PRIMARY KEY AUTO_INCREMENT,
    keyword VARCHAR(100) NOT NULL COMMENT '搜索关键词',
    search_count INT DEFAULT 1 COMMENT '搜索次数',
    last_search_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '最后搜索时间',
    INDEX idx_keyword (keyword),
    INDEX idx_count (search_count)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='搜索关键词表';
```

---

## 三、API接口设计

### 3.1 产品相关接口

#### 3.1.1 获取产品列表

```http
GET /api/products

Query Parameters:
- page: 页码 (默认1)
- pageSize: 每页数量 (默认12)
- categoryId: 分类ID
- minPrice: 最低价格
- maxPrice: 最高价格
- brand: 品牌
- sort: 排序方式 (price_asc, price_desc, sales, newest)
- keyword: 搜索关键词

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1,
        "name": "高效杀虫剂",
        "category_id": 1,
        "price": 88.00,
        "original_price": 108.00,
        "thumbnail_url": "https://...",
        "sales_count": 128,
        "is_hot": 1,
        "is_new": 0,
        "specification": {"weight": "500ml", "packing": "瓶装"},
        "created_at": "2026-01-28 10:00:00"
      }
    ],
    "pagination": {
      "page": 1,
      "pageSize": 12,
      "total": 100,
      "totalPages": 9
    }
  }
}
```

#### 3.1.2 获取产品详情

```http
GET /api/products/:id

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "name": "高效杀虫剂",
    "category_id": 1,
    "category_name": "杀虫剂",
    "brand": "苏顺植保",
    "price": 88.00,
    "original_price": 108.00,
    "stock": 500,
    "sales_count": 128,
    "image_urls": ["https://...", "https://..."],
    "specification": {
      "weight": "500ml",
      "packing": "瓶装",
      "active_ingredient": "25%吡虫啉",
      "control_objects": ["蚜虫", "飞虱", "蓟马"]
    },
    "description": "详细描述内容...",
    "features": ["高效", "安全", "持效期长"],
    "usage_method": "使用方法说明...",
    "precautions": "注意事项...",
    "specs": [
      {"id": 1, "spec_name": "规格", "spec_value": "500ml", "price": 88.00},
      {"id": 2, "spec_name": "规格", "spec_value": "1000ml", "price": 158.00}
    ],
    "related_products": [
      {"id": 2, "name": "杀菌剂", "price": 128.00, "thumbnail_url": "https://..."}
    ]
  }
}
```

#### 3.1.3 获取产品分类

```http
GET /api/categories

Response:
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 1,
      "name": "杀虫剂",
      "parent_id": 0,
      "level": 1,
      "icon": "fa-bug",
      "children": [
        {"id": 11, "name": "蚜虫专用", "parent_id": 1, "level": 2}
      ]
    }
  ]
}
```

#### 3.1.4 获取热门搜索词

```http
GET /api/products/hot-search

Response:
{
  "code": 200,
  "message": "success",
  "data": [
    {"keyword": "杀虫剂", "search_count": 1256},
    {"keyword": "杀菌剂", "search_count": 987},
    {"keyword": "除草剂", "search_count": 854}
  ]
}
```

### 3.2 咨询相关接口

#### 3.2.1 提交咨询

```http
POST /api/consultations

Request Body:
{
  "product_id": 1,
  "type": 1,
  "subject": "产品咨询",
  "content": "请问这个产品对水稻稻飞虱效果如何？",
  "contact_info": {
    "name": "张三",
    "phone": "13800138000",
    "email": "zhangsan@example.com",
    "wechat": "zhangsan123"
  }
}

Response:
{
  "code": 200,
  "message": "提交成功，我们会尽快与您联系！",
  "data": {
    "id": 1001,
    "ticket_code": "CZ202601280001"
  }
}
```

#### 3.2.2 获取咨询列表（用户端）

```http
GET /api/consultations/my

Query Parameters:
- page: 页码
- pageSize: 每页数量
- status: 状态筛选

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [
      {
        "id": 1001,
        "ticket_code": "CZ202601280001",
        "product_id": 1,
        "product_name": "高效杀虫剂",
        "type": 1,
        "subject": "产品咨询",
        "content": "咨询内容...",
        "status": 2,
        "status_text": "已回复",
        "reply_count": 2,
        "last_reply_at": "2026-01-28 15:30:00",
        "created_at": "2026-01-28 10:00:00"
      }
    ],
    "pagination": {...}
  }
}
```

#### 3.2.3 获取咨询详情

```http
GET /api/consultations/:id

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1001,
    "ticket_code": "CZ202601280001",
    "product": {...},
    "user": {...},
    "type": 1,
    "subject": "产品咨询",
    "content": "咨询内容...",
    "contact_info": {...},
    "status": 2,
    "priority": 2,
    "replies": [
      {
        "id": 1,
        "user_id": 100,
        "user_name": "客服小王",
        "content": "回复内容...",
        "is_admin": 1,
        "created_at": "2026-01-28 11:00:00"
      }
    ],
    "created_at": "2026-01-28 10:00:00"
  }
}
```

#### 3.2.4 回复咨询

```http
POST /api/consultations/:id/replies

Request Body:
{
  "content": "您好，这款产品对水稻稻飞虱有很好的防治效果..."
}

Response:
{
  "code": 200,
  "message": "回复成功",
  "data": {
    "id": 2,
    "content": "回复内容...",
    "created_at": "2026-01-28 15:30:00"
  }
}
```

#### 3.2.5 管理咨询列表（管理员）

```http
GET /api/admin/consultations

Query Parameters:
- page: 页码
- pageSize: 每页数量
- status: 状态
- priority: 优先级
- assigned_to: 分配给谁
- startDate: 开始日期
- endDate: 结束日期

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "list": [...],
    "pagination": {...},
    "statistics": {
      "total": 156,
      "pending": 23,
      "processing": 45,
      "replied": 78,
      "closed": 10
    }
  }
}
```

### 3.3 聊天相关接口

#### 3.3.1 创建聊天会话

```http
POST /api/chats/sessions

Request Body:
{
  "to_user_id": 100
}

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "session_id": "chat_1234567890",
    "to_user": {
      "id": 100,
      "name": "客服小王",
      "avatar": "https://..."
    }
  }
}
```

#### 3.3.2 获取聊天历史

```http
GET /api/chats/sessions/:session_id/messages

Query Parameters:
- page: 页码
- pageSize: 每页数量 (默认50)

Response:
{
  "code": 200,
  "message": "success",
  "data": {
    "messages": [
      {
        "id": 1,
        "from_user_id": 1,
        "from_user_name": "张三",
        "content": "你好",
        "type": 1,
        "is_read": 1,
        "created_at": "2026-01-28 10:00:00"
      }
    ]
  }
}
```

#### 3.3.3 发送消息（WebSocket）

```javascript
// 客户端发送
{
  "type": "chat_message",
  "data": {
    "session_id": "chat_1234567890",
    "to_user_id": 100,
    "content": "你好，我想咨询一下产品",
    "type": 1
  }
}

// 服务器广播
{
  "type": "new_message",
  "data": {
    "id": 123,
    "session_id": "chat_1234567890",
    "from_user_id": 1,
    "from_user_name": "张三",
    "content": "你好，我想咨询一下产品",
    "type": 1,
    "created_at": "2026-01-28 10:00:00"
  }
}
```

#### 3.3.4 标记消息已读

```http
PUT /api/chats/messages/:id/read

Response:
{
  "code": 200,
  "message": "success"
}
```

---

## 四、前端实现方案

### 4.1 产品展示模块

#### 4.1.1 产品列表页

```html
<!-- product-list.html -->
<div class="product-list-page">
  <!-- 搜索栏 -->
  <div class="search-bar">
    <div class="search-input-wrapper">
      <input type="text" v-model="searchKeyword" placeholder="搜索产品..." @keyup.enter="handleSearch">
      <button @click="handleSearch"><i class="fas fa-search"></i></button>
    </div>
    <div class="hot-search">
      <span>热门搜索：</span>
      <a v-for="item in hotSearch" :key="item.keyword" @click="search(item.keyword)">
        {{ item.keyword }}
      </a>
    </div>
  </div>

  <!-- 筛选栏 -->
  <div class="filter-sidebar">
    <!-- 分类筛选 -->
    <div class="filter-section">
      <h3>产品分类</h3>
      <ul class="category-list">
        <li v-for="cat in categories" :key="cat.id" :class="{active: selectedCategory === cat.id}">
          <a @click="selectCategory(cat.id)">{{ cat.name }}</a>
          <span class="count">{{ cat.product_count }}</span>
        </li>
      </ul>
    </div>

    <!-- 价格筛选 -->
    <div class="filter-section">
      <h3>价格区间</h3>
      <div class="price-filter">
        <input type="range" v-model="priceRange.min" min="0" max="500">
        <input type="range" v-model="priceRange.max" min="0" max="500">
        <div class="price-display">¥{{ priceRange.min }} - ¥{{ priceRange.max }}</div>
        <button @click="applyPriceFilter">筛选</button>
      </div>
    </div>

    <!-- 品牌筛选 -->
    <div class="filter-section">
      <h3>品牌</h3>
      <div class="brand-list">
        <label v-for="brand in brands" :key="brand">
          <input type="checkbox" v-model="selectedBrands" :value="brand">
          {{ brand }}
        </label>
      </div>
    </div>
  </div>

  <!-- 产品列表 -->
  <div class="product-grid">
    <div class="product-card" v-for="product in productList" :key="product.id">
      <div class="product-image">
        <img :src="product.thumbnail_url" :alt="product.name">
        <span class="badge" v-if="product.is_hot">热销</span>
        <span class="badge" v-if="product.is_new">新品</span>
      </div>
      <div class="product-info">
        <h3 class="product-title">{{ product.name }}</h3>
        <p class="product-desc">{{ product.description }}</p>
        <div class="product-price">
          <span class="current-price">¥{{ product.price }}</span>
          <span class="original-price" v-if="product.original_price">¥{{ product.original_price }}</span>
        </div>
        <div class="product-actions">
          <button @click="viewDetail(product.id)">查看详情</button>
          <button @click="addToCart(product.id)">加入购物车</button>
          <button @click="startConsult(product.id)">咨询</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 分页 -->
  <div class="pagination">
    <button @click="prevPage" :disabled="currentPage === 1">上一页</button>
    <span v-for="page in totalPages" :key="page" :class="{active: currentPage === page}" @click="goToPage(page)">
      {{ page }}
    </span>
    <button @click="nextPage" :disabled="currentPage === totalPages">下一页</button>
  </div>
</div>
```

#### 4.1.2 产品详情页

```html
<!-- product-detail.html -->
<div class="product-detail-page">
  <!-- 产品图片 -->
  <div class="product-images">
    <div class="main-image">
      <img :src="currentImage" :alt="product.name">
      <button @click="zoomImage"><i class="fas fa-search-plus"></i></button>
    </div>
    <div class="thumbnail-list">
      <img v-for="(img, index) in product.image_urls" :key="index" :src="img" @click="currentImage = img">
    </div>
  </div>

  <!-- 产品信息 -->
  <div class="product-info">
    <h1 class="product-title">{{ product.name }}</h1>
    <div class="product-meta">
      <span class="brand">品牌：{{ product.brand }}</span>
      <span class="sales">销量：{{ product.sales_count }}件</span>
    </div>
    <div class="product-price-section">
      <span class="current-price">¥{{ product.price }}</span>
      <span class="original-price" v-if="product.original_price">¥{{ product.original_price }}</span>
      <span class="stock">库存：{{ product.stock }}件</span>
    </div>

    <!-- 规格选择 -->
    <div class="spec-selection" v-if="product.specs.length > 0">
      <h3>选择规格</h3>
      <div class="spec-options">
        <label v-for="spec in product.specs" :key="spec.id">
          <input type="radio" v-model="selectedSpec" :value="spec">
          <span>{{ spec.spec_value }} - ¥{{ spec.price }}</span>
        </label>
      </div>
    </div>

    <!-- 购买数量 -->
    <div class="quantity-selector">
      <label>购买数量：</label>
      <button @click="decreaseQuantity">-</button>
      <input type="number" v-model="quantity" min="1" :max="selectedSpec.stock">
      <button @click="increaseQuantity">+</button>
    </div>

    <!-- 操作按钮 -->
    <div class="action-buttons">
      <button class="btn-primary" @click="addToCart">加入购物车</button>
      <button class="btn-secondary" @click="buyNow">立即购买</button>
      <button class="btn-chat" @click="startConsult(product.id)">
        <i class="fas fa-comments"></i> 在线咨询
      </button>
    </div>
  </div>

  <!-- 产品详情 -->
  <div class="product-detail-section">
    <div class="detail-tabs">
      <button :class="{active: activeTab === 'detail'}" @click="activeTab = 'detail'">产品详情</button>
      <button :class="{active: activeTab === 'specs'}" @click="activeTab = 'specs'">规格参数</button>
      <button :class="{active: activeTab === 'usage'}" @click="activeTab = 'usage'">使用说明</button>
    </div>

    <div class="detail-content">
      <!-- 产品详情 -->
      <div v-if="activeTab === 'detail'" class="detail-content">
        <div class="features">
          <h3>产品特点</h3>
          <ul>
            <li v-for="(feature, index) in product.features" :key="index">{{ feature }}</li>
          </ul>
        </div>
        <div class="description" v-html="product.description"></div>
      </div>

      <!-- 规格参数 -->
      <div v-if="activeTab === 'specs'" class="specs-table">
        <table>
          <tbody>
            <tr v-for="(value, key) in product.specification" :key="key">
              <td>{{ key }}</td>
              <td>{{ value }}</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 使用说明 -->
      <div v-if="activeTab === 'usage'" class="usage-info">
        <div class="usage-method">
          <h3>使用方法</h3>
          <p>{{ product.usage_method }}</p>
        </div>
        <div class="precautions">
          <h3>注意事项</h3>
          <p>{{ product.precautions }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- 相关产品 -->
  <div class="related-products">
    <h3>相关产品</h3>
    <div class="related-grid">
      <div class="related-item" v-for="item in product.related_products" :key="item.id">
        <img :src="item.thumbnail_url" :alt="item.name">
        <h4>{{ item.name }}</h4>
        <p class="price">¥{{ item.price }}</p>
      </div>
    </div>
  </div>
</div>
```

### 4.2 在线沟通模块

#### 4.2.1 联系表单组件

```html
<!-- contact-form.html -->
<div class="contact-form-modal" :class="{show: visible}">
  <div class="modal-overlay" @click="close"></div>
  <div class="modal-content">
    <div class="modal-header">
      <h2>在线咨询</h2>
      <button class="close-btn" @click="close"><i class="fas fa-times"></i></button>
    </div>

    <form @submit.prevent="submitForm">
      <div class="form-group">
        <label>咨询类型</label>
        <select v-model="formData.type">
          <option value="1">产品咨询</option>
          <option value="2">价格咨询</option>
          <option value="3">技术咨询</option>
          <option value="4">其他</option>
        </select>
      </div>

      <div class="form-group">
        <label>咨询主题 *</label>
        <input type="text" v-model="formData.subject" required placeholder="请输入咨询主题">
      </div>

      <div class="form-group">
        <label>咨询内容 *</label>
        <textarea v-model="formData.content" required rows="5" placeholder="请详细描述您的问题..."></textarea>
      </div>

      <div class="form-group">
        <label>您的姓名 *</label>
        <input type="text" v-model="formData.contact_info.name" required placeholder="请输入您的姓名">
      </div>

      <div class="form-group">
        <label>联系电话 *</label>
        <input type="tel" v-model="formData.contact_info.phone" required placeholder="请输入您的手机号">
      </div>

      <div class="form-group">
        <label>电子邮箱</label>
        <input type="email" v-model="formData.contact_info.email" placeholder="请输入您的邮箱">
      </div>

      <div class="form-group">
        <label>微信号</label>
        <input type="text" v-model="formData.contact_info.wechat" placeholder="请输入您的微信号">
      </div>

      <div class="form-group">
        <label>验证码 *</label>
        <div class="captcha-input">
          <input type="text" v-model="formData.captcha" required placeholder="请输入验证码">
          <img :src="captchaUrl" @click="refreshCaptcha">
        </div>
      </div>

      <button type="submit" class="submit-btn" :disabled="submitting">
        {{ submitting ? '提交中...' : '提交咨询' }}
      </button>
    </form>
  </div>
</div>
```

#### 4.2.2 即时聊天组件

```html
<!-- chat-window.html -->
<div class="chat-widget" :class="{expanded: isExpanded}">
  <!-- 聊天头部 -->
  <div class="chat-header" @click="toggleExpand">
    <div class="chat-avatar">
      <img :src="currentAgent.avatar" :alt="currentAgent.name">
      <span class="status online"></span>
    </div>
    <div class="chat-info">
      <h4>{{ currentAgent.name }}</h4>
      <p>在线客服</p>
    </div>
    <div class="chat-actions">
      <button @click="minimize"><i class="fas fa-minus"></i></button>
      <button @click="close"><i class="fas fa-times"></i></button>
    </div>
  </div>

  <!-- 聊天内容 -->
  <div class="chat-content" ref="chatContent">
    <!-- 消息列表 -->
    <div class="message-list">
      <div class="message-item" v-for="msg in messages" :key="msg.id" :class="{self: msg.from_user_id === currentUserId}">
        <div class="message-avatar">
          <img :src="msg.user_avatar" :alt="msg.user_name">
        </div>
        <div class="message-body">
          <div class="message-content" :class="{text: msg.type === 1, image: msg.type === 2}">
            <span v-if="msg.type === 1">{{ msg.content }}</span>
            <img v-if="msg.type === 2" :src="msg.file_url" v-viewer>
          </div>
          <div class="message-time">{{ formatTime(msg.created_at) }}</div>
        </div>
      </div>

      <!-- 加载更多 -->
      <div class="load-more" v-if="hasMore" @click="loadMore">
        <button>加载更多</button>
      </div>
    </div>
  </div>

  <!-- 输入区域 -->
  <div class="chat-input-area">
    <div class="input-toolbar">
      <button class="toolbar-btn" @click="selectImage"><i class="fas fa-image"></i></button>
      <button class="toolbar-btn" @click="selectFile"><i class="fas fa-paperclip"></i></button>
      <button class="toolbar-btn" @click="clearInput"><i class="fas fa-eraser"></i></button>
    </div>

    <div class="input-wrapper">
      <textarea v-model="inputMessage" @keydown.enter.exact="sendMessage" placeholder="请输入消息..."></textarea>
      <button class="send-btn" @click="sendMessage" :disabled="!inputMessage.trim()">
        <i class="fas fa-paper-plane"></i>
      </button>
    </div>
  </div>
</div>

<!-- 聊天列表侧边栏 -->
<div class="chat-sidebar" :class="{show: showSidebar}">
  <div class="sidebar-header">
    <h3>我的对话</h3>
    <button @click="closeSidebar"><i class="fas fa-times"></i></button>
  </div>

  <div class="session-list">
    <div class="session-item" v-for="session in sessions" :key="session.id" :class="{active: session.id === currentSessionId}">
      <div class="session-avatar">
        <img :src="session.user_avatar" :alt="session.user_name">
        <span class="status" :class="session.is_online ? 'online' : 'offline'"></span>
      </div>
      <div class="session-info">
        <h4>{{ session.user_name }}</h4>
        <p class="last-message">{{ session.last_message }}</p>
        <p class="session-time">{{ formatTime(session.last_active) }}</p>
      </div>
      <div class="session-meta">
        <span class="unread" v-if="session.unread_count">{{ session.unread_count }}</span>
      </div>
    </div>
  </div>
</div>
```

---

## 五、后端实现方案

### 5.1 项目结构

```
backend/
├── config/
│   ├── database.js          # 数据库配置
│   ├── redis.js             # Redis配置
│   └── email.js             # 邮件配置
├── models/
│   ├── Product.js           # 产品模型
│   ├── Category.js          # 分类模型
│   ├── Consultation.js      # 咨询模型
│   ├── ChatMessage.js       # 聊天模型
│   └── User.js              # 用户模型
├── controllers/
│   ├── productController.js
│   ├── consultationController.js
│   ├── chatController.js
│   └── searchController.js
├── routes/
│   ├── productRoutes.js
│   ├── consultationRoutes.js
│   ├── chatRoutes.js
│   └── index.js
├── services/
│   ├── productService.js
│   ├── searchService.js
│   ├── emailService.js
│   ├── notificationService.js
│   └── chatService.js
├── middleware/
│   ├── auth.js              # 认证中间件
│   ├── validator.js         # 验证中间件
│   └── errorHandler.js      # 错误处理
├── sockets/
│   └── chatSocket.js        # WebSocket处理
├── utils/
│   ├── response.js          # 响应工具
│   ├── logger.js            # 日志工具
│   └── helpers.js           # 辅助函数
└── app.js                   # 应用入口
```

### 5.2 产品服务实现

```javascript
// productService.js
const { Product, Category, ProductSpec } = require('../models');

class ProductService {
  // 获取产品列表
  async getProductList(query) {
    const { page = 1, pageSize = 12, categoryId, minPrice, maxPrice, brand, sort, keyword } = query;
    
    const where = {};
    if (categoryId) where.category_id = categoryId;
    if (minPrice) where.price = { [Op.gte]: minPrice };
    if (maxPrice) where.price = { ...where.price, [Op.lte]: maxPrice };
    if (brand) where.brand = brand;
    if (keyword) {
      where[Op.or] = [
        { name: { [Op.like]: `%${keyword}%` } },
        { description: { [Op.like]: `%${keyword}%` } },
        { brand: { [Op.like]: `%${keyword}%` } }
      ];
    }

    const order = [];
    switch (sort) {
      case 'price_asc': order.push(['price', 'ASC']); break;
      case 'price_desc': order.push(['price', 'DESC']); break;
      case 'sales': order.push(['sales_count', 'DESC']); break;
      case 'newest': order.push(['created_at', 'DESC']); break;
      default: order.push(['sort_order', 'ASC']);
    }

    const { count, rows } = await Product.findAndCountAll({
      where,
      order,
      limit: pageSize,
      offset: (page - 1) * pageSize,
      attributes: ['id', 'name', 'price', 'original_price', 'thumbnail_url', 'sales_count', 'is_hot', 'is_new']
    });

    return {
      list: rows,
      pagination: {
        page: parseInt(page),
        pageSize: parseInt(pageSize),
        total: count,
        totalPages: Math.ceil(count / pageSize)
      }
    };
  }

  // 获取产品详情
  async getProductDetail(id) {
    const product = await Product.findByPk(id, {
      include: [
        {
          model: ProductSpec,
          as: 'specs'
        }
      ]
    });

    if (!product) {
      throw new Error('产品不存在');
    }

    // 获取相关产品
    const relatedProducts = await Product.findAll({
      where: {
        category_id: product.category_id,
        id: { [Op.ne]: id }
      },
      limit: 4,
      attributes: ['id', 'name', 'price', 'thumbnail_url']
    });

    return {
      ...product.toJSON(),
      related_products: relatedProducts
    };
  }

  // 搜索产品
  async searchProducts(keyword) {
    // 记录搜索关键词
    await this.recordSearchKeyword(keyword);

    return this.getProductList({ keyword });
  }

  // 记录搜索关键词
  async recordSearchKeyword(keyword) {
    const [record, created] = await SearchKeyword.findOrCreate({
      where: { keyword },
      defaults: { search_count: 1 }
    });

    if (!created) {
      await record.increment('search_count');
      await record.update({ last_search_at: new Date() });
    }
  }

  // 获取热门搜索词
  async getHotSearch(limit = 10) {
    return SearchKeyword.findAll({
      order: [['search_count', 'DESC']],
      limit,
      attributes: ['keyword', 'search_count']
    });
  }
}

module.exports = new ProductService();
```

### 5.3 咨询服务实现

```javascript
// consultationService.js
const { Consultation, ConsultationReply, User } = require('../models');
const emailService = require('./emailService');
const notificationService = require('./notificationService');

class ConsultationService {
  // 提交咨询
  async submitConsultation(data, userId = null) {
    const consultation = await Consultation.create({
      user_id: userId,
      product_id: data.product_id,
      type: data.type,
      subject: data.subject,
      content: data.content,
      contact_info: JSON.stringify(data.contact_info),
      status: 0,
      priority: this.getPriority(data.type),
      ticket_code: this.generateTicketCode()
    });

    // 发送通知给客服
    await notificationService.notifyAdmins('new_consultation', {
      consultation_id: consultation.id,
      ticket_code: consultation.ticket_code,
      subject: consultation.subject
    });

    // 发送确认邮件
    if (data.contact_info.email) {
      await emailService.sendConsultationConfirmation({
        email: data.contact_info.email,
        name: data.contact_info.name,
        ticket_code: consultation.ticket_code,
        subject: consultation.subject
      });
    }

    return consultation;
  }

  // 回复咨询
  async replyConsultation(consultationId, replyData, userId) {
    const consultation = await Consultation.findByPk(consultationId);
    
    if (!consultation) {
      throw new Error('咨询不存在');
    }

    const reply = await ConsultationReply.create({
      consultation_id: consultationId,
      user_id: userId,
      content: replyData.content,
      is_admin: replyData.is_admin
    });

    // 更新咨询状态
    await consultation.update({
      status: 2,
      reply_count: consultation.reply_count + 1,
      last_reply_at: new Date(),
      is_read: 0
    });

    // 通知用户
    if (consultation.user_id) {
      await notificationService.notifyUser(consultation.user_id, 'consultation_replied', {
        consultation_id: consultationId,
        reply_content: replyData.content
      });
    }

    // 发送邮件通知
    const contactInfo = JSON.parse(consultation.contact_info);
    if (contactInfo.email) {
      await emailService.sendConsultationReply({
        email: contactInfo.email,
        name: contactInfo.name,
        subject: consultation.subject,
        reply_content: replyData.content
      });
    }

    return reply;
  }

  // 获取咨询列表（管理端）
  async getAdminConsultations(query) {
    const { page = 1, pageSize = 20, status, priority, assigned_to, startDate, endDate } = query;

    const where = {};
    if (status) where.status = status;
    if (priority) where.priority = priority;
    if (assigned_to) where.assigned_to = assigned_to;
    if (startDate) where.created_at = { [Op.gte]: startDate };
    if (endDate) where.created_at = { ...where.created_at, [Op.lte]: endDate };

    const { count, rows } = await Consultation.findAndCountAll({
      where,
      order: [['priority', 'ASC'], ['created_at', 'DESC']],
      limit: pageSize,
      offset: (page - 1) * pageSize,
      include: [{
        model: User,
        as: 'user',
        attributes: ['id', 'username', 'phone', 'email']
      }]
    });

    // 统计数据
    const statistics = await this.getStatistics();

    return {
      list: rows,
      pagination: {
        page: parseInt(page),
        pageSize: parseInt(pageSize),
        total: count,
        totalPages: Math.ceil(count / pageSize)
      },
      statistics
    };
  }

  // 获取统计数据
  async getStatistics() {
    const [total, pending, processing, replied, closed] = await Promise.all([
      Consultation.count(),
      Consultation.count({ where: { status: 0 } }),
      Consultation.count({ where: { status: 1 } }),
      Consultation.count({ where: { status: 2 } }),
      Consultation.count({ where: { status: 3 } })
    ]);

    return { total, pending, processing, replied, closed };
  }

  // 生成工单编号
  generateTicketCode() {
    const date = new Date();
    const year = date.getFullYear();
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const day = String(date.getDate()).padStart(2, '0');
    const random = Math.floor(Math.random() * 10000).toString().padStart(4, '0');
    
    return `CZ${year}${month}${day}${random}`;
  }

  // 获取优先级
  getPriority(type) {
    const priorityMap = {
      1: 2, // 产品咨询 - 中
      2: 2, // 价格咨询 - 中
      3: 1, // 技术咨询 - 高
      4: 3  // 其他 - 低
    };
    return priorityMap[type] || 2;
  }
}

module.exports = new ConsultationService();
```

### 5.4 WebSocket聊天实现

```javascript
// chatSocket.js
const socketIo = require('socket.io');
const ChatMessage = require('../models/ChatMessage');
const notificationService = require('../services/notificationService');

class ChatSocket {
  constructor(server) {
    this.io = socketIo(server, {
      cors: {
        origin: '*',
        methods: ['GET', 'POST']
      }
    });

    this.userSockets = new Map(); // userId -> socketId
    this.socketUsers = new Map(); // socketId -> userId
    this.sessionSockets = new Map(); // sessionId -> Set<socketId>

    this.setupHandlers();
  }

  setupHandlers() {
    this.io.on('connection', (socket) => {
      console.log('用户连接:', socket.id);

      // 用户认证
      socket.on('authenticate', async (data) => {
        const { user_id, token } = data;
        
        // 验证token
        const isValid = await this.validateToken(token);
        if (!isValid) {
          socket.emit('auth_failed', { message: '认证失败' });
          socket.disconnect();
          return;
        }

        this.userSockets.set(user_id, socket.id);
        this.socketUsers.set(socket.id, user_id);
        socket.user_id = user_id;

        socket.emit('authenticated');
      });

      // 加入会话
      socket.on('join_session', async (data) => {
        const { session_id } = data;
        socket.join(session_id);

        if (!this.sessionSockets.has(session_id)) {
          this.sessionSockets.set(session_id, new Set());
        }
        this.sessionSockets.get(session_id).add(socket.id);
      });

      // 发送消息
      socket.on('send_message', async (data) => {
        const { session_id, to_user_id, content, type } = data;
        const from_user_id = socket.user_id;

        // 保存消息
        const message = await ChatMessage.create({
          session_id,
          from_user_id,
          to_user_id,
          content,
          type,
          file_url: data.file_url
        });

        // 广播消息
        this.io.to(session_id).emit('new_message', {
          ...message.toJSON(),
          from_user_id,
          to_user_id
        });

        // 发送通知给接收者
        if (this.userSockets.has(to_user_id)) {
          const recipientSocketId = this.userSockets.get(to_user_id);
          this.io.to(recipientSocketId).emit('notification', {
            type: 'new_message',
            session_id,
            from_user_id,
            content
          });
        } else {
          // 用户不在线，保存离线消息
          await notificationService.saveOfflineMessage(to_user_id, {
            session_id,
            from_user_id,
            content
          });
        }
      });

      // 标记消息已读
      socket.on('mark_read', async (data) => {
        const { session_id, message_ids } = data;
        
        await ChatMessage.update(
          { is_read: 1 },
          { where: { id: message_ids } }
        );

        this.io.to(session_id).emit('messages_read', { message_ids });
      });

      // 正在输入
      socket.on('typing', (data) => {
        const { session_id } = data;
        socket.to(session_id).emit('user_typing', {
          user_id: socket.user_id
        });
      });

      // 断开连接
      socket.on('disconnect', () => {
        console.log('用户断开:', socket.id);
        
        const userId = this.socketUsers.get(socket.id);
        if (userId) {
          this.userSockets.delete(userId);
          this.socketUsers.delete(socket.id);
        }

        // 从所有会话中移除
        this.sessionSockets.forEach((sockets, sessionId) => {
          sockets.delete(socket.id);
        });
      });
    });
  }

  async validateToken(token) {
    // 实现token验证逻辑
    return true;
  }

  // 发送系统消息
  async sendSystemMessage(sessionId, content) {
    this.io.to(sessionId).emit('system_message', {
      content,
      timestamp: new Date()
    });
  }
}

module.exports = ChatSocket;
```

---

## 六、咨询处理流程

### 6.1 咨询提交流程

```
用户填写表单
    ↓
前端验证数据
    ↓
调用API提交咨询
    ↓
后端保存数据到数据库
    ↓
生成工单编号
    ↓
发送通知给客服（实时推送）
    ↓
发送确认邮件/短信给用户
    ↓
返回成功响应
```

### 6.2 咨询处理流程

```
客服收到通知
    ↓
查看咨询列表
    ↓
分配咨询（自动/手动）
    ↓
更新状态为"处理中"
    ↓
查看咨询详情
    ↓
回复咨询
    ↓
发送通知给用户
    ↓
更新状态为"已回复"
    ↓
用户查看回复
    ↓
用户可以继续追问
    ↓
咨询结束，关闭工单
```

### 6.3 即时聊天流程

```
用户打开聊天窗口
    ↓
连接WebSocket
    ↓
认证用户身份
    ↓
创建或加入会话
    ↓
加载历史消息
    ↓
发送消息
    ↓
WebSocket广播消息
    ↓
保存到数据库
    ↓
对方接收消息
    ↓
标记已读
```

---

## 七、通知与提醒机制

### 7.1 通知类型

**客服端通知**：
- 新咨询提醒
- 新消息提醒
- 待处理任务提醒
- 超时未处理提醒

**用户端通知**：
- 咨询提交确认
- 咨询回复通知
- 聊天消息提醒
- 服务结束通知

### 7.2 通知方式

**实时推送**：
- WebSocket推送
- 浏览器Notification API

**离线通知**：
- 邮件通知
- 短信通知
- 微信公众号推送

### 7.3 通知服务实现

```javascript
// notificationService.js
const emailService = require('./emailService');
const smsService = require('./smsService');

class NotificationService {
  // 通知管理员
  async notifyAdmins(type, data) {
    const admins = await User.findAll({ where: { role: 1 } });

    for (const admin of admins) {
      // WebSocket推送
      if (this.userSockets.has(admin.id)) {
        const socketId = this.userSockets.get(admin.id);
        this.io.to(socketId).emit('admin_notification', {
          type,
          data,
          timestamp: new Date()
        });
      }
    }
  }

  // 通知用户
  async notifyUser(userId, type, data) {
    const user = await User.findByPk(userId);
    if (!user) return;

    // WebSocket推送
    if (this.userSockets.has(userId)) {
      const socketId = this.userSockets.get(userId);
      this.io.to(socketId).emit('notification', {
        type,
        data,
        timestamp: new Date()
      });
    } else {
      // 离线通知
      await this.sendOfflineNotification(user, type, data);
    }
  }

  // 发送离线通知
  async sendOfflineNotification(user, type, data) {
    const notifications = [];

    if (user.email) {
      notifications.push(this.sendEmailNotification(user.email, type, data));
    }

    if (user.phone) {
      notifications.push(this.sendSmsNotification(user.phone, type, data));
    }

    await Promise.all(notifications);
  }

  // 发送邮件通知
  async sendEmailNotification(email, type, data) {
    const templates = {
      consultation_submitted: {
        subject: '咨询提交确认',
        template: 'consultation-confirmation'
      },
      consultation_replied: {
        subject: '咨询已回复',
        template: 'consultation-reply'
      }
    };

    const template = templates[type];
    if (!template) return;

    await emailService.send(email, template.subject, template.template, data);
  }

  // 发送短信通知
  async sendSmsNotification(phone, type, data) {
    const templates = {
      consultation_submitted: '您的咨询已提交，工单号：{ticket_code}，我们会尽快处理。',
      consultation_replied: '您的咨询已有回复，请登录查看。'
    };

    const template = templates[type];
    if (!template) return;

    const content = this.formatTemplate(template, data);
    await smsService.send(phone, content);
  }

  formatTemplate(template, data) {
    return template.replace(/{(\w+)}/g, (_, key) => data[key] || '');
  }
}

module.exports = new NotificationService();
```

---

## 八、性能优化方案

### 8.1 前端优化

**图片优化**：
- 使用WebP格式
- 图片懒加载
- CDN加速
- 响应式图片（srcset）

**代码优化**：
- 代码分割（Code Splitting）
- 组件懒加载
- 虚拟滚动（长列表）
- 防抖节流（搜索、滚动）

**缓存策略**：
- 静态资源缓存（Cache-Control）
- API请求缓存（localStorage/sessionStorage）
- 路由缓存（keep-alive）

### 8.2 后端优化

**数据库优化**：
- 合理使用索引
- 数据库连接池
- 查询优化（避免N+1问题）
- 读写分离

**缓存策略**：
- Redis缓存热门数据
- 缓存产品列表
- 缓存分类数据
- 缓存搜索结果

**负载均衡**：
- Nginx负载均衡
- 水平扩展
- 分布式部署

### 8.3 搜索优化

**全文搜索**：
- 使用Elasticsearch
- 数据库全文索引
- 搜索建议（自动补全）
- 搜索结果高亮

---

## 九、安全考虑

### 9.1 数据安全

**输入验证**：
- 前端验证
- 后端验证
- SQL注入防护（使用ORM）
- XSS防护（转义输出）

**数据加密**：
- 密码加密（bcrypt）
- 敏感数据加密存储
- HTTPS传输

**权限控制**：
- 用户角色权限
- API接口权限
- 数据访问权限

### 9.2 业务安全

**防刷机制**：
- 接口限流
- 验证码（图形/短信）
- 频率限制

**数据备份**：
- 定时备份数据库
- 异地备份
- 灾难恢复

---

## 十、部署方案

### 10.1 服务器架构

```
负载均衡（Nginx）
    ↓
┌─────────────┬─────────────┐
│   Web服务器  │   Web服务器  │
│  (Node.js)  │  (Node.js)  │
└─────────────┴─────────────┘
    ↓
数据库服务器（MySQL）
    ↓
缓存服务器（Redis）
    ↓
文件存储（OSS）
```

### 10.2 环境配置

**开发环境**：
- 本地开发
- 本地数据库
- 调试模式

**测试环境**：
- 独立服务器
- 测试数据库
- 模拟数据

**生产环境**：
- 正式服务器
- 主从数据库
- 性能监控

### 10.3 容器化部署

```dockerfile
# Dockerfile
FROM node:16-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install --production

COPY . .

EXPOSE 3000

CMD ["npm", "start"]
```

```yaml
# docker-compose.yml
version: '3.8'

services:
  web:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - DB_HOST=mysql
      - REDIS_HOST=redis
    depends_on:
      - mysql
      - redis

  mysql:
    image: mysql:8.0
    environment:
      - MYSQL_ROOT_PASSWORD=root
      - MYSQL_DATABASE=shop
    volumes:
      - mysql-data:/var/lib/mysql

  redis:
    image: redis:alpine
    volumes:
      - redis-data:/data

volumes:
  mysql-data:
  redis-data:
```

---

## 总结

本技术方案详细设计了产品展示和业务沟通系统的完整实现方案，包括：

1. **数据库设计**：8张核心表，涵盖产品、分类、用户、咨询、聊天等
2. **API接口**：RESTful API + WebSocket，完整的接口文档
3. **前端实现**：Vue.js/React组件，产品展示、筛选、搜索、咨询、聊天
4. **后端实现**：Node.js + Express，服务层、控制器、模型
5. **沟通机制**：联系表单 + 即时聊天，完整的咨询处理流程
6. **通知系统**：实时推送 + 邮件/短信通知
7. **性能优化**：缓存、CDN、负载均衡
8. **安全考虑**：输入验证、数据加密、权限控制

该方案可以直接用于实际开发，具有良好的扩展性和可维护性。

---

*文档版本：v1.0*
*创建日期：2026-01-28*
*适用场景：苏顺植保网站*
